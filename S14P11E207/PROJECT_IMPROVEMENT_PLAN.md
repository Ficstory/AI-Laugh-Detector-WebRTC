# π—οΈ ν”„λ΅μ νΈ μ „μ²΄ κ°μ„  κ³„ν (Project Improvement Plan)

3-Persona Deep Dive (μ‹λ‹μ–΄ μ—”μ§€λ‹μ–΄ μ‹¬μΈµ λ¶„μ„) κ²°κ³Όλ¥Ό ν†µν•©ν•μ—¬, **μΈν”„λΌ(Infrastructure)**μ™€ **λ°±μ—”λ“(Backend)** μ „λ°μ **μ•μ •μ„±(Stability)**κ³Ό **λ³΄μ•(Security)**μ„ μµμ°μ„ μΌλ΅ ν• κ°μ„  κ³„νμ…λ‹λ‹¤.

---

## π¨ P0: κΈ΄κΈ‰ μμ • (Critical & Security)
*μ΄μ ν™κ²½ λ°°ν¬ μ „ λ°λ“μ‹ ν•΄κ²°ν•΄μ•Ό ν•λ” μΉλ…μ  λ¦¬μ¤ν¬μ…λ‹λ‹¤.*

### 1. Spring Actuator λ¬΄λ°©λΉ„ λ…Έμ¶ (Security Breach)
- **ν„μƒ**: `SecurityConfig`μ—μ„ `/actuator/**` μ—”λ“ν¬μΈνΈκ°€ `permitAll()`λ΅ μ„¤μ •λμ–΄ μμ.
- **μ„ν—**: ν™ λ¤ν”„, ν™κ²½λ³€μ, Bean μ •λ³΄ λ“± μ„λ²„ λ‚΄λ¶€ μ •λ³΄κ°€ μ™Έλ¶€λ΅ μ μ¶λ  κ²½μ° **μ„λ²„ νƒμ·¨**λ΅ μ΄μ–΄μ§ μ μμµλ‹λ‹¤ (μ‹¬κ°λ„: μµμƒ).
- **κ°μ„ **: `/actuator/health`λ§ ν—μ©ν•κ³ , λ―Όκ° μ—”λ“ν¬μΈνΈλ” μ°¨λ‹¨ν•κ±°λ‚ λ‚΄λ¶€λ§(Private IP)μ—μ„λ§ μ ‘κ·Ό κ°€λ¥ν•λ„λ΅ ACL μ„¤μ •.

### 2. Jenkins Credentials ν‰λ¬Έ κ΄€λ¦¬
- **ν„μƒ**: `jenkins.yaml` λ‚΄ κ΄€λ¦¬μ λΉ„λ°€λ²νΈμ™€ μ—°λ™ ν† ν°μ΄ ν™κ²½λ³€μλ΅ μ£Όμ…λλ‚, `.env` νμΌ λ“±μ— ν‰λ¬ΈμΌλ΅ λ³΄κ΄€λ  κ°€λ¥μ„± λ†’μ.
- **μ„ν—**: CI/CD νμ΄ν”„λΌμΈμ΄ νƒμ·¨λλ©΄ μ†μ¤μ½”λ“ λ³€μ΅° λ° λ°°ν¬λ§ μ¥μ•…μ΄ κ°€λ¥ν•©λ‹λ‹¤.
- **κ°μ„ **: Docker Secrets λλ” Jenkins Credentials Pluginμ„ ν™μ©ν• μ•”νΈν™” κ΄€λ¦¬ λ„μ….

### 3. Nginx DoS μ·¨μ•½μ  λ° μ„¤μ • λ¶μ•μ •
- **ν„μƒ**: `client_max_body_size 100M` μ„¤μ •μ΄ μ „μ—­μΌλ΅ μ μ©λ¨. `switch-upstream.sh`κ°€ `sed`λ΅ μ„¤μ • νμΌμ„ μ§μ ‘ μμ •ν•¨.
- **μ„ν—**: λ€μ©λ‰ νμΌ λ™μ‹ μ—…λ΅λ“ κ³µκ²©(DoS)μ— μ·¨μ•½ν•λ©°, λ°°ν¬ μ¤ν¬λ¦½νΈ μ‹¤ν–‰ μ¤‘ μ„¤μ • νμΌ μ¤μ—Ό μ„ν—μ΄ νΌ.
- **κ°μ„ **:
    - **Symlink Switching**: `sed` λ€μ‹  μ‹¬λ³Όλ¦­ λ§ν¬ κµμ²΄(`ln -sf`) λ°©μ‹μΌλ΅ λ¬΄μ¤‘λ‹¨ λ°°ν¬ μ›μμ„±(Atomicity) ν™•λ³΄.
    - **Rate Limiting**: μ—…λ΅λ“ κ²½λ΅ ν•μ •μΌλ΅ μ©λ‰ μ ν• μ μ© λ° μ”μ²­ λΉλ„ μ ν•(Limit Req) μ„¤μ •.

### 4. λ©”λ¨λ¦¬ λ¶€μ΅±(OOM)μΌλ΅ μΈν• μ‹μ¤ν… λ‹¤μ΄
- **ν„μƒ**: `t3.xlarge` (16GB) ν™κ²½μ—μ„ Blue/Green λ°°ν¬ μ‹ WAS 2λ€ + Jenkins λ™μ‹ κµ¬λ™ μ‹ λ©”λ¨λ¦¬ κ³ κ° μ„ν—.
- **κ°μ„ **:
    - **Swap Memory**: 4GB μ΄μƒ μ¤μ™‘ μ„¤μ •μΌλ΅ OOM Killer λ°©μ–΄.
    - **Safe Deployment**: "λΉλ“ ν›„ μ¤‘λ‹¨(Build First)" μ „λµμΌλ΅ λ°°ν¬ μ¤‘λ‹¨ μ‹κ°„ μµμ†ν™”.

---

## π› οΈ P1: μ μ§€λ³΄μμ„± λ° κµ¬μ΅° κ°μ„  (Refactoring)
*μ μ§€λ³΄μ λΉ„μ© μ κ°κ³Ό μ½”λ“ ν’μ§ ν–¥μƒμ„ μ„ν• ν•„μ κ°μ„  μ‚¬ν•­μ…λ‹λ‹¤.*

### 5. URL μ²λ¦¬ λ΅μ§ ννΈν™” (Shotgun Surgery)
- **ν„μƒ**: `MinioService`μ Presigned URL μƒμ„± λ΅μ§κ³Ό `UserService`μ ν”„λ΅ν•„ μ΄λ―Έμ§€ URL μ΅°λ¦½ λ΅μ§μ΄ λ¶„λ¦¬λμ–΄ μμ.
- **μ„ν—**: CDN λ„μ…μ΄λ‚ λ„λ©”μΈ λ³€κ²½ μ‹ μμ • λ„λ½μΌλ΅ μΈν• λ§ν¬ κΉ¨μ§(Broken Link) λ°μƒ κ°€λ¥μ„±.
- **κ°μ„ **: `UrlResolver` μ»΄ν¬λ„νΈλ΅ URL μƒμ„±/μ΅°λ¦½ μ±…μ„ **λ‹¨μΌν™”(SRP)**.

### 6. λΉ„μ¦λ‹μ¤ λ΅μ§ λ‚΄ κ²€μ¦ μ½”λ“ νΌμ¬
- **ν„μƒ**: `UserService` λ“±μ—μ„ `if (nickname == null)` κ°™μ€ λ‹¨μ κ²€μ¦ μ½”λ“κ°€ λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό μ„μ—¬ μμ.
- **κ°μ„ **: DTO(`@Valid`, `@NotNull`)λ΅ κ²€μ¦ μ±…μ„μ„ λ„κΈ°κ³ , μ„λΉ„μ¤ κ³„μΈµμ€ **μμ λΉ„μ¦λ‹μ¤ λ΅μ§**μ—λ§ μ§‘μ¤‘.

---

## π€ P2: μ„±λ¥ μµμ ν™” (Optimization)
### 7. Stateful μ—°κ²° λΉ„μ© μµμ ν™”
- **ν„μƒ**: `checkObjectExists` λ“±μ—μ„ λ§¤λ² μ™Έλ¶€ μ¤ν† λ¦¬μ§€(MinIO)λ΅ λ„¤νΈμ›ν¬ I/O λ°μƒ.
- **κ°μ„ **: Redis μΊμ‹±μ„ λ„μ…ν•μ—¬ λ¶ν•„μ”ν• I/O μ κ±° λ° μ‘λ‹µ μ†λ„ ν–¥μƒ.

---

## π“… μΆ…ν•© μκ²¬
ν„μ¬ μ•„ν‚¤ν…μ²λ” "κΈ°λ¥ κµ¬ν„" λ‹¨κ³„λ” λ„μ–΄μ„°μΌλ‚, **"μ΄μ μμ¤€μ λ³΄μ•κ³Ό μ•μ •μ„±"** μΈ΅λ©΄μ—μ„ λ³΄κ°•μ΄ μ‹κΈ‰ν•©λ‹λ‹¤.
νΉν **Actuator λ³΄μ•**κ³Ό **Nginx Symlink μ „ν™**μ€ λ°°ν¬ μ§μ „ λ°λ“μ‹ μν–‰ν•΄μ•Ό ν•  **Blocker**κΈ‰ μ΄μλ΅ νλ‹¨λ©λ‹λ‹¤.

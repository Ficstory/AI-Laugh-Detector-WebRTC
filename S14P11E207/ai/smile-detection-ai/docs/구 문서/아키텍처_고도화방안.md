# ì›ƒìŒ ê°ì§€ AI - ì•„í‚¤í…ì²˜ ì „ëµ ìµœì¢…

**ì‘ì„±ì¼**: 2026-01-14
**ëª©ì **: Yìí˜• Multi-task Learning ì „ëµ ì •ë¦¬

---

## ğŸ¯ í•µì‹¬ ì „ëµ

### ë¬¸ì œ ì¸ì‹

1. **ë‹¨ìˆœ ì´ì§„ ë¶„ë¥˜ì˜ í•œê³„**
   - ì›ƒìŒ vs ë¹„ì›ƒìŒë§Œ íŒë‹¨ â†’ UIê°€ ë‹¨ì¡°ë¡œì›€
   - ë¯¸ì„¸í•œ ë³€í™”(ì›ƒìŒ ì°¸ê¸°) ì‹œê°í™” ì–´ë ¤ì›€

2. **ë‹¨ìˆœ ê°ì • ë¶„ë¥˜ì˜ í•œê³„**
   - FER2013ì˜ "Happiness"ëŠ” ê°ì •ì´ì§€ í‘œì •ì´ ì•„ë‹˜
   - ì–µì§€ì›ƒìŒ, ë¹„ì›ƒìŒ ë“± ë³µì¡í•œ ìƒí™© ëŒ€ì‘ ë¶ˆê°€

### í•´ê²°ì±…: Hybrid Multi-Head

**í•˜ë‚˜ì˜ ëª¨ë¸, ë‘ ê°œì˜ ì „ë¬¸ í—¤ë“œ**

```
ì…ë ¥ ì´ë¯¸ì§€ ì‹œí€€ìŠ¤ (10 í”„ë ˆì„)
    â†“
MobileNetV3-Small (Backbone)
    â†“
Bidirectional LSTM
    â†“
    â”œâ”€â†’ Head 1 (Smile Detection)
    â”‚    â””â”€â†’ ì›ƒìŒ ê°•ë„: 0.00~1.00 (ê²Œì„ íŒì •ìš©)
    â”‚
    â””â”€â†’ Head 2 (Emotion Classification)
         â””â”€â†’ 7ê°€ì§€ ê°ì • í™•ë¥  (UI ëŒ€ì‹œë³´ë“œìš©)
```

---

## ğŸ§  í•µì‹¬ ê°œë…: Smile vs Happiness

### Smile (í‘œì • - ë¬¼ë¦¬ì )

- **ì •ì˜**: ì… ì£¼ë³€ ê·¼ìœ¡ì˜ ë¬¼ë¦¬ì  ì›€ì§ì„
- **ì¸¡ì •**: ì…ê¼¬ë¦¬ ê°ë„, ì¹˜ì•„ ë…¸ì¶œ, ì… ë²Œë¦¼ ì •ë„
- **ë²”ìœ„**: 0.0 (ì „í˜€ ì•ˆ ì›ƒìŒ) ~ 1.0 (í¬ê²Œ ì›ƒìŒ)
- **Head**: Head 1 (Binary/Continuous)
- **ë°ì´í„°ì…‹**: GENKI-4K, SMILES

### Happiness (ê°ì • - ì‹¬ë¦¬ì )

- **ì •ì˜**: ë‚´ë©´ì˜ ê¸°ì¨, í–‰ë³µí•œ ì‹¬ë¦¬ ìƒíƒœ
- **ì¸¡ì •**: ì „ë°˜ì ì¸ í‘œì • ì¡°í•© (ì…, ëˆˆ, ëº¨ ë“±)
- **ë²”ìœ„**: 7ê°€ì§€ ê°ì • ì¤‘ í•˜ë‚˜
- **Head**: Head 2 (Multi-class)
- **ë°ì´í„°ì…‹**: FER2013

### ì°¨ì´ì˜ ì¬ë¯¸ (ê²Œì„ í•µì‹¬)

| ìƒí™© | Head 1 (Smile) | Head 2 (Happiness) | ê²°ê³¼ |
|------|----------------|-------------------|------|
| ì§„ì‹¬ ì›ƒìŒ | 0.90 | 0.88 | OUT (ê°ì •ê³¼ í‘œì • ì¼ì¹˜) |
| ì–µì§€ ì›ƒìŒ | 0.75 | 0.10 (Neutral) | ì°¨ì´ ë°œìƒ â†’ ì¬ë¯¸! |
| ì›ƒìŒ ì°¸ê¸° | 0.30 | 0.85 | ì°¸ëŠ” ì¤‘ ê°ì§€ |
| ë¹„ì›ƒìŒ | 0.55 | 0.70 (Disgust) | ì›ƒì§€ë§Œ í˜ì˜¤ ê°ì • |

---

## ğŸ“Š í•™ìŠµ ì „ëµ: Masked Multi-task Loss

### ë¬¸ì œì 

- GENKI-4K: ì›ƒìŒ ë¼ë²¨ë§Œ ìˆìŒ (ê°ì • ì—†ìŒ)
- FER2013: ê°ì • ë¼ë²¨ë§Œ ìˆìŒ (ì›ƒìŒ ì •ë°€ ìˆ˜ì¹˜ ì—†ìŒ)
- í•œêµ­ì¸ ë°ì´í„°ì…‹: ë‘ ë¼ë²¨ ëª¨ë‘ ìˆìŒ

**â†’ ë°ì´í„°ì…‹ë§ˆë‹¤ ë¼ë²¨ì´ ë‹¤ë¥¸ë° ì–´ë–»ê²Œ í•œ ëª¨ë¸ë¡œ í•™ìŠµ?**

### í•´ê²°ì±…: Masked Loss

```python
# GENKI-4K ë°ì´í„°ê°€ ë“¤ì–´ì˜¬ ë•Œ
head1_mask = [1, 1, 1, 1]  # Head 1 Loss ê³„ì‚°
head2_mask = [0, 0, 0, 0]  # Head 2 Loss ë¬´ì‹œ

# FER2013 ë°ì´í„°ê°€ ë“¤ì–´ì˜¬ ë•Œ
head1_mask = [0, 0, 0, 0]  # Head 1 Loss ë¬´ì‹œ
head2_mask = [1, 1, 1, 1]  # Head 2 Loss ê³„ì‚°

# í•œêµ­ì¸ ë°ì´í„°ì…‹
head1_mask = [1, 1, 1, 1]  # Head 1 Loss ê³„ì‚°
head2_mask = [1, 1, 1, 1]  # Head 2 Loss ê³„ì‚°

# Total Loss
total_loss = head1_weight * masked_head1_loss + head2_weight * masked_head2_loss
```

### í•™ìŠµ ë‹¨ê³„

#### Phase 1: Pretrain (GENKI-4K + FER2013)

```python
for batch in dataloader:
    if batch.dataset == 'genki4k':
        # Head 1ë§Œ í•™ìŠµ
        head1_mask = torch.ones(batch_size)
        head2_mask = torch.zeros(batch_size)

    elif batch.dataset == 'fer2013':
        # Head 2ë§Œ í•™ìŠµ
        head1_mask = torch.zeros(batch_size)
        head2_mask = torch.ones(batch_size)

    loss = criterion(
        smile_pred, emotion_pred,
        smile_target, emotion_target,
        head1_mask, head2_mask
    )

    loss['total_loss'].backward()
    optimizer.step()
```

#### Phase 2: Fine-tuning (í•œêµ­ì¸ ë°ì´í„°ì…‹)

```python
for batch in korean_dataloader:
    # ë‘ í—¤ë“œ ëª¨ë‘ í•™ìŠµ
    head1_mask = torch.ones(batch_size)
    head2_mask = torch.ones(batch_size)

    loss = criterion(
        smile_pred, emotion_pred,
        smile_target, emotion_target,
        head1_mask, head2_mask
    )
```

---

## ğŸ® UI ì¶œë ¥ ì „ëµ

### ê²Œì„ í™”ë©´ ì˜ˆì‹œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ì›ƒìŒ ì°¸ê¸° ê²Œì„]                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  ğŸ¯ íŒì • ê²Œì´ì§€ (Head 1: Smile Detection)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0.82  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  ì„ê³„ê°’: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”ƒ 0.80                    â”‚
â”‚           OUT!!! ğŸ˜†                             â”‚
â”‚                                                 â”‚
â”‚  ğŸ“Š ê°ì • ìƒíƒœ (Head 2: Emotion)                  â”‚
â”‚  ì¤‘ë¦½:    â–ˆâ–ˆ 5.47%                              â”‚
â”‚  ë¶„ë…¸:    â–‘ 0.03%                               â”‚
â”‚  í˜ì˜¤:    â–‘ 0.32%                               â”‚
â”‚  ê³µí¬:    â–‘ 0.00%                               â”‚
â”‚  í–‰ë³µ:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 88.11%           â”‚
â”‚  ìŠ¬í””:    â–‘ 0.05%                               â”‚
â”‚  ë†€ëŒ:    â–‘ 0.02%                               â”‚
â”‚                                                 â”‚
â”‚  ğŸ’¡ ë¶„ì„: ì§„ì‹¬ìœ¼ë¡œ ì›ƒê³  ìˆìŠµë‹ˆë‹¤!                  â”‚
â”‚  (í–‰ë³µ 88% + ì›ƒìŒ 82% = ê°ì • í‘œì • ì¼ì¹˜)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2ë‹¨ê³„ ê²€ì¦ ë¡œì§ (ì˜µì…˜)

```python
# UIì—ì„œ í™œì„±í™” ê°€ëŠ¥í•œ ëª¨ë“œ
if config.ui.two_stage_verification:
    # 1ë‹¨ê³„: Head 2ì˜ Happiness ì²´í¬
    if emotion_probs[HAPPINESS_IDX] > 0.5:
        # 2ë‹¨ê³„: Head 1ì˜ Smile ì •ë°€ ì¸¡ì •
        if smile_prob > threshold:
            result = "OUT!"
            show_red_gauge = True
        else:
            result = "SAFE"
    else:
        # Happiness ë‚®ìœ¼ë©´ ì›ƒìŒ ê²Œì´ì§€ ë¹„í™œì„±
        show_red_gauge = False
        result = "SAFE"
else:
    # ë‹¨ìˆœ ëª¨ë“œ: Head 1ë§Œ ì‚¬ìš©
    result = "OUT!" if smile_prob > threshold else "SAFE"
```

---

## ğŸ”§ Loss ê°€ì¤‘ì¹˜ ì„¤ì • ê¶Œì¥ê°’

### ì´ˆê¸° í•™ìŠµ (Pretrain)

```yaml
training:
  loss:
    head1_weight: 1.0    # Smile Detection
    head2_weight: 1.0    # Emotion Classification
    focal_loss: false    # ê· í˜• ì¡íŒ ë°ì´í„°ì…‹
    label_smoothing: 0.1
    adaptive: false
```

### Fine-tuning (í•œêµ­ì¸ ë°ì´í„°ì…‹)

```yaml
training:
  loss:
    head1_weight: 2.0    # Smileì— ë” ì§‘ì¤‘ (ê²Œì„ìš©)
    head2_weight: 1.0    # Emotionì€ ë³´ì¡°
    focal_loss: false
    label_smoothing: 0.05
    adaptive: true       # ìë™ ê°€ì¤‘ì¹˜ ì¡°ì •
```

### í•œêµ­ì¸ íŠ¹í™” (ì–µì§€ì›ƒìŒ, ì›ƒìŒ ì°¸ê¸° ì§‘ì¤‘)

```yaml
training:
  loss:
    head1_weight: 3.0    # ë¯¸ì„¸í•œ ë³€í™” ê°ì§€
    head2_weight: 1.0
    focal_loss: true     # ì–´ë ¤ìš´ ìƒ˜í”Œ(ì–µì§€ì›ƒìŒ) ì§‘ì¤‘
    focal_gamma: 2.0
    label_smoothing: 0.0
    adaptive: false
```

---

## ğŸ“ˆ ê¸°ëŒ€ íš¨ê³¼

### 1. ê²Œì„ ì¬ë¯¸ ì¦ê°€

- **ë¯¸ì„¸í•œ ë³€í™” ì‹œê°í™”**: 0.78 â†’ 0.82 â†’ OUT!
- **ê°ì • ë¶„ì„ ì¶”ê°€**: "ì§€ê¸ˆ í–‰ë³µí•˜ì§€ë§Œ ì–µì§€ë¡œ ì°¸ëŠ” ì¤‘"
- **ë‚œì´ë„ ì¡°ì ˆ**: ì„ê³„ê°’ 0.5~0.9 ì‚¬ìš©ì ì„¤ì •

### 2. í•œêµ­ì¸ íŠ¹í™”

- **ì–µì§€ì›ƒìŒ ê°ì§€**: Head 1 ë†’ìŒ + Head 2 Neutral
- **ì›ƒìŒ ì°¸ê¸° ê°ì§€**: Head 1 ë‚®ìŒ + Head 2 Happiness
- **ë¬¸í™”ê¶Œ í‘œì •**: í•œêµ­ì¸ ë°ì´í„°ë¡œ Fine-tuning

### 3. ê¸°ìˆ ì  ì´ì 

- **Multi-task Learning**: Backbone ê³µìœ ë¡œ íš¨ìœ¨ì 
- **Masked Loss**: ë°ì´í„°ì…‹ í•œê³„ ê·¹ë³µ
- **ìœ ì—°ì„±**: í—¤ë“œë³„ ë…ë¦½ í•™ìŠµ ê°€ëŠ¥

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

1. âœ… Multi-task Loss êµ¬í˜„ ì™„ë£Œ
2. âœ… Masked Loss í…ŒìŠ¤íŠ¸ í†µê³¼
3. âœ… í•œêµ­ì¸ ë°ì´í„°ì…‹ ë¼ë²¨ë§ ê°€ì´ë“œ ì‘ì„±
4. â¬œ ë°ì´í„° ë¡œë” êµ¬í˜„ (GENKI-4K, FER2013, í•œêµ­ì¸)
5. â¬œ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
6. â¬œ í•™ìŠµ ì‹¤í–‰ ë° ê²€ì¦
7. â¬œ UI í”„ë¡œí† íƒ€ì… ê°œë°œ

---

## ğŸ“š ì°¸ê³  ìë£Œ

### ë…¼ë¬¸

- **Multi-Task Learning Using Uncertainty to Weigh Losses** (Kendall et al., 2018)
  - ì ì‘í˜• Loss ê°€ì¤‘ì¹˜ ê¸°ë²•
  - https://arxiv.org/abs/1705.07115

- **Facial Action Unit Detection** (Li et al., 2017)
  - í‘œì •ì˜ ë¬¼ë¦¬ì  ë³€í™” ì¸¡ì •
  - https://arxiv.org/abs/1705.01212

### ë°ì´í„°ì…‹

- GENKI-4K: ì›ƒìŒ vs ë¹„ì›ƒìŒ (4,000ì¥)
- FER2013: 7ê°€ì§€ ê°ì • (35,887ì¥)
- SMILES: ì›ƒìŒ vs ë¹„ì›ƒìŒ (1,203ì¥)

---

**ì‘ì„±ì**: AI Development Team
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2026-01-14
**ìŠ¹ì¸**: âœ… ì „ëµ í™•ì •
